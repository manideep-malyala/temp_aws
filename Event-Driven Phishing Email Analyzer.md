
# Event-Driven Phishing Email Analyzer

## 🎯 Target Audience

* **General Public**
* **Corporate Security Teams**
* **Internal Security Awareness Programs**
* **Cybersecurity Reporting Platforms**

---

## 💡 Core Concept

A user sees a suspicious email and forwards it to a special email address like `report-phishing@my-safe-domain.com`.
Behind the scenes, an automated AI-powered system analyzes the forwarded message for red flags—including spoofed headers, scam language, and malicious links—and then **emails back a full phishing report** to the original sender.

This becomes a **serverless, event-driven, AI-based security assistant** that’s always listening and ready to respond with intelligent insights.

---

## 🏗️ AWS Architecture & Workflow

> *Only uses S3, Lambda, and Bedrock Agent. All parsing and extraction logic handled via Lambda.*

### 📥 **Trigger (S3)**

* A suspicious email is **forwarded by a user** to a public mailbox (e.g., `report-phishing@...`)
* The email system (MVP scope) **simulates this** by placing a raw `.eml` or `.txt` email file into:

  * **Bucket**: `S3-Inbox-Emails`
* This upload **triggers** the `Email-Analysis-Lambda`

---

### ⚙️ **Orchestration (Lambda → Bedrock)**

* **Function**: `Email-Analysis-Lambda`
* **Responsibilities**:

  * Reads the `.eml` or `.txt` file from `S3-Inbox-Emails`
  * Internally performs:

    * **Header Extraction**
    * **Body Text and Link Extraction**
    * **URL Analysis**
  * Passes the cleaned metadata and email content to the **Bedrock Agent**
  * Receives a synthesized phishing report
  * Sends the report (via frontend for MVP) or logs it for now

---

### 🧠 **Agentic Analysis (Bedrock Agent)**

* **Agent Name**: `PhishingDetectionAgent`
* **Input Schema** (constructed by Lambda):

```json
{
  "headers": {
    "From": "...",
    "Return-Path": "...",
    "SPF": "fail",
    "DKIM": "none"
  },
  "body_text": "Urgent: Your account is blocked. Click here to restore access.",
  "urls": [
    "http://suspicious-login-page.ru"
  ]
}
```

* **Agent Tasks**:

  1. Analyze headers for spoofing signs (e.g., mismatched Return-Path, failed SPF)
  2. Detect manipulative or scam language in email body
  3. Evaluate reputation and intent of URLs (basic heuristic in text)
  4. Summarize all findings in a human-readable format

#### 📄 Output:

```markdown
# 🛑 Phishing Email Analysis Report

## ✅ Header Analysis
- **SPF:** Failed
- **DKIM:** None
- **Return-Path** does not match From address

## 📜 Body Analysis
- Language uses urgency and fear: "Your account is blocked."
- No personal identifiers, generic language: likely mass-targeted

## 🔗 Link Analysis
- URL: `http://suspicious-login-page.ru`
- Domain is unrelated to the real brand
- Heuristic analysis: potential credential phishing site

---

### 🧠 Verdict: HIGH RISK – LIKELY PHISHING

> Do not click any links or provide any information.

—
Generated by Bedrock Phishing Agent
```

---

## 🔁 Hackathon Viability

| Criteria              | Evaluation                                                |
| --------------------- | --------------------------------------------------------- |
| **Uniqueness**        | ⭐⭐⭐⭐⭐ – Email-based phishing reporting made intelligent   |
| **Public Value**      | ⭐⭐⭐⭐⭐ – Easy to use, no technical expertise needed        |
| **Feasibility (MVP)** | ⭐⭐⭐⭐⭐ – Fully serverless using only S3, Lambda, Bedrock   |
| **LLM Integration**   | ⭐⭐⭐⭐⭐ – Agent acts as reasoning core for report synthesis |
| **Demo Ready**        | ⭐⭐⭐⭐ – Upload `.eml` to simulate phishing report cycle    |

---

## 🔧 Internal Lambda Tools (Optional Implementation Within Lambda)

Although you’re limited to a single Lambda function, the logic can be modularized as follows:

### 🧩 **Header Parser (Internal Logic)**

* Extracts `From`, `Return-Path`, `SPF`, and `DKIM` lines from the raw `.eml`
* Detects mismatches and missing validations

### 🧩 **Body Analyzer (Internal Logic)**

* Extracts plain text from HTML or body
* Searches for high-risk keywords (e.g., "act now," "limited time," "suspend your account")

### 🧩 **URL Reputation Checker (Heuristic)**

* Flags domains that:

  * Are new, obscure, or unrelated to known brands
  * Use IP-based URLs or country-code TLDs
  * Appear in scam keyword contexts

---
